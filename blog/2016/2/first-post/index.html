<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="initial-scale=1.0, user-scalable=1">
<meta name="author" content="Alex Johnstone">
<meta property="og:type" content="website" />

<meta property="og:title" content="Hello Website" />
<meta property="og:url" content="" />

<link rel="stylesheet" href="/alexjj.com/static/style.css?h=c5234797">
<link rel="shortcut icon" href="/alexjj.com/static/favicon.png">
<title>Hello Website — alexjj.com</title>
</head>
<body>
  <section>
      <header>
          <nav>
              <ul><a href="/alexjj.com/"><img src="/alexjj.com/static/cat.png" alt="meow" style="height:100px"></a>
              </ul>
              <ul>
                
                    <li><code><a href="/alexjj.com/">Home</a></code></li>
              
                    <li><code><a href="/alexjj.com/blog/">Blog</a></code></li>
              
                    <li><code><a href="/alexjj.com/about/">About</a></code></li>
              
            </ul>
        </nav>
    </header>
    <article>
        
  
  
    <h2>Hello Website</h2>
  
  <p><small>
    written by Alex Johnstone on 2016-02-02
    </small></p>
  <p>This is an example blog post.  Not much here but that's not the point :)</p>
<p>Testing markdown highlighter:</p>
<p><code></p>
<p><pre>
import datetime
from selenium import webdriver
from time import sleep
</pre>
&lt;/code&gt;</p>
<pre><code>code with no highlighting: &lt;pre&gt;
import datetime
from selenium import webdriver
from time import sleep
</code></pre>
<pre><code class="lang-python">&#39;&#39;&#39;
Index fund scraper.
This python script will take a list of funds and look up their price from iii.co.uk,
then write them to a pricesdb file for ledger-cli&#39;s usage.
Run cron daily/weekly/monthly
python ukfundprices.py
&#39;&#39;&#39;
__author__ = &quot;Alex Johnstone &lt;alexjj@gmail.com&gt;&quot;

import datetime
from selenium import webdriver
from time import sleep


# List of funds to look up. Tuple as names are never going to change
funds = (&#39;FIAAGY&#39;,
         &#39;VVDVWE&#39;,
         &#39;VVFUSI&#39;,
         &#39;MYKAAS&#39;,
         &#39;VIUKGO&#39;,
         &#39;VIGSCA&#39;)

base_url = &#39;http://www.iii.co.uk/investment/detail?code=mex:&#39;
end_url = &#39;&amp;it=ukut&#39;

ledger_pricedb_file = &#39;/home/alex/money/ledger.pricedb.test&#39;


# Make the ledger string

def make_ledger_str(fund, price):
    now = datetime.datetime.today()
    timestamp = now.strftime(&quot;%Y/%m/%d %H:%M:%S&quot;)
    string = &quot;P &quot; + timestamp + &quot; &quot; + fund + 10 * &quot; &quot; + str(price) + &quot; GBP&quot;
    return string


def get_prices():
    price_list = []
    for fund in funds:
        browser = webdriver.PhantomJS()
        browser.get(base_url + fund + end_url)
        price = browser.find_element_by_class_name(&#39;price&#39;).text
        string = make_ledger_str(fund, price)
        price_list.append(string)
        browser.quit()
        sleep(1)  #Kept getting connection refused
    return price_list


def write_prices(price_list):
    with open(ledger_pricedb_file, &#39;a&#39;) as text_file:
        for string in price_list:
            print(string, file=text_file)




if __name__ == &quot;__main__&quot;:
    price_list = get_prices()
    write_prices(price_list)
</code></pre>


  
<div id="disqus_thread"></div>
<script>
  var disqus_config = function() { this.page.identifier = "/blog/first-post"; this.page.url = "https://alexjj.github.io/alexjj.com/blog/2016/2/first-post/"; };
  (function() {
    var d = document, s = d.createElement('script');
    s.src = '//alexjj.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript>
  Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript"
    rel="nofollow">comments powered by Disqus.</a>
</noscript>


    </article>
    <footer>
      <nav>
        <ul>
          <li><small>| (• ◡•)| <a target="blank" href="https://github.com/alexjj/alexjj.com" title="Source">♥</a> (❍ᴥ❍ʋ)<small>
          </li>
        </ul>
      </nav>
    </footer>
  </section>
</body>
</html>
